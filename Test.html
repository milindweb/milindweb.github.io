<form id="contactForm"
      action="https://script.google.com/macros/s/AKfycbyCa9s8LQYQmaZ2WIx1duPVogBCREBp1r3nj9isYp61rgmEtwMdaiq9W5YTsrzjh67c/exec"
      method="POST"
      style="max-width: 800px; margin: auto; padding: 1.5rem; background: #f9f9f9; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; flex-wrap: wrap; gap: 1rem;">

  <select name="for" required>
    <option value="">Select Service</option>
    <option>SEO & Digital Marketing</option>
    <option>Web Designing</option>
    <option>Software Solutions</option>
    <option>Graphics Designing</option>
    <option>Projects & Workshop</option>
    <option>Any Other</option>
  </select>

  <input type="text" name="name" placeholder="Your Name" required />
  <input type="email" name="email" placeholder="Email (e.g., abc@xyz.com)" required />
  <input type="tel" name="phone" pattern="^\d{10}$" placeholder="10-digit Phone" required />
  <textarea name="message" placeholder="Your Message" required></textarea>

  <button type="submit">Submit</button>
  <div id="responseMessage"></div>
</form>

<script>
  const form = document.getElementById('contactForm');
  const responseBox = document.getElementById('responseMessage');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData(form);

    // Add IP before submission
    let ip = "Unknown";
    try {
      const ipRes = await fetch("https://api.ipify.org?format=json");
      ip = (await ipRes.json()).ip;
    } catch {}

    formData.append("ip", ip);

    try {
      const response = await fetch(form.action, { method: "POST", body: formData });
      const result = await response.json();

      if (result.result === "success") {
        responseBox.textContent = "✅ Submitted successfully! Our team will reach out to you shortly.";
        form.reset();
        setTimeout(() => { responseBox.textContent = ""; }, 15000);
      } else {
        responseBox.textContent = "❌ " + result.message;
      }
    } catch (err) {
      responseBox.textContent = "⚠️ Error: " + err.message;
    }
  });
</script>
