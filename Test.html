<form id="contactForm"
      style="max-width: 800px; margin: auto; padding: 1.5rem; background: #f9f9f9; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; flex-wrap: wrap; gap: 1rem;">

  <select name="for" required style="width: 100%; padding: 10px;">
    <option value="">Select Service</option>
    <option>SEO & Digital Marketing</option>
    <option>Web Designing</option>
    <option>Software Solutions</option>
    <option>Graphics Designing</option>
    <option>Projects & Workshop</option>
    <option>Any Other</option>
  </select>

  <input type="text" name="name" placeholder="Your Name" required style="width: 100%; padding: 10px;">
  <input type="email" name="email" placeholder="Email (e.g., abc@xyz.com)" required style="width: 100%; padding: 10px;">
  <input type="tel" name="phone" pattern="^\d{10}$" placeholder="10-digit Phone" required style="width: 100%; padding: 10px;">
  <textarea name="message" placeholder="Your Message" required style="width: 100%; padding: 10px; height: 120px;"></textarea>

  <button type="submit" style="background: #4285f4; color: white; border: none; padding: 12px 20px; border-radius: 4px; cursor: pointer;">Submit</button>
  <div id="responseMessage" style="width: 100%; text-align: center; padding: 10px; font-weight: bold;"></div>
</form>

<script>
  document.getElementById('contactForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const form = e.target;
    const responseBox = document.getElementById('responseMessage');
    
    // Show loading state
    responseBox.textContent = "⏳ Submitting...";
    responseBox.style.color = "#333";
    
    try {
      // Get user's IP
      const ipRes = await fetch('https://api.ipify.org?format=json');
      const { ip } = await ipRes.json();
      
      // Prepare form data
      const formData = new FormData(form);
      formData.append('ip', ip);
      
      // Send to Google Apps Script
      const response = await fetch(
        'https://script.google.com/macros/s/AKfycbyCa9s8LQYQmaZ2WIx1duPVogBCREBp1r3nj9isYp61rgmEtwMdaiq9W5YTsrzjh67c/exec', 
        {
          method: 'POST',
          body: formData
        }
      );
      
      const result = await response.json();
      
      // Show result message
      responseBox.textContent = result.message;
      responseBox.style.color = result.result === "success" ? "green" : "red";
      
      // Reset form on success
      if (result.result === "success") form.reset();
      
    } catch (error) {
      responseBox.textContent = "⚠️ Network error. Please try again.";
      responseBox.style.color = "red";
    }
    
    // Clear message after 15 seconds
    setTimeout(() => {
      responseBox.textContent = "";
    }, 15000);
  });
</script>
