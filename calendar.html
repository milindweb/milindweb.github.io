<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Milindweb - Calendar Year</title>

  <!-- Shared Header + Footer CSS -->
  <link rel="stylesheet" href="css/headerfooter.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* ===== Body ===== */
    body {
      font-family: Arial, sans-serif; /* text font */
      margin: 0; /* remove default margin */
      padding: 0; /* remove default padding */
      background: #fff; /* page background color */
      color: #000; /* default text color */
      text-align: center; /* center headings */
    }

    h1 {
      margin: 10px 0; /* spacing above/below */
      font-size: 1.8rem; /* heading size */
    }

    /* ===== Controls ===== */
    .cy-controls {
      margin: 10px; /* spacing */
      display: flex; /* flex layout */
      justify-content: center; /* center content horizontally */
      flex-wrap: wrap; /* wrap on small screens */
      gap: 10px; /* gap between buttons/select */
    }
    .cy-controls select, .cy-controls button {
      padding: 6px 12px; /* inner spacing */
      font-size: 15px; /* text size */
      border-radius: 4px; /* rounded corners */
      border: 1px solid #999; /* border color */
      cursor: pointer; /* pointer on hover */
      background: #fff; /* button background */
      color: #000; /* button text color */
    }

    /* ===== Calendar Layout ===== */
    .cy-calendar {
      display: flex; /* flex layout */
      flex-wrap: wrap; /* wrap months */
      justify-content: center; /* center months */
      gap: 10px; /* spacing between months */
      padding: 10px; /* padding around calendar */
    }
    .cy-month {
      flex: 1 1 230px; /* flexible width */
      max-width: 250px; /* max width */
      border: 1px solid #999; /* outer border of month */
      border-radius: 4px; /* rounded corners */
      overflow: hidden; /* hide overflow */
      background: #f9f9f9; /* month background */
    }
    .cy-month h2 {
      margin: 0; /* no margin */
      padding: 4px; /* padding around text */
      font-size: 1rem; /* text size */
      color: #000; /* text color */
    }
    .cy-month table {
      width: 100%; /* full width */
      border-collapse: collapse; /* remove double borders */
      font-size: 0.8rem; /* small text */
    }
    .cy-month th, .cy-month td {
      padding: 4px; /* cell padding */
      text-align: center; /* center text */
      min-width: 24px; /* minimum width */
      border: none; /* remove cell borders */
    }
    .cy-month th {
      font-weight: bold; /* bold header text */
    }

    /* ===== Month header colors ===== */
    .cy-m0 h2 { background: #99ccff; }   /* Jan */
    .cy-m1 h2 { background: #ccffff; }   /* Feb */
    .cy-m2 h2 { background: #99ffcc; }   /* Mar */
    .cy-m3 h2 { background: #ccff99; }   /* Apr */
    .cy-m4 h2 { background: #ccff66; }   /* May */
    .cy-m5 h2 { background: #ffff99; }   /* Jun */
    .cy-m6 h2 { background: #ffcc66; }   /* Jul */
    .cy-m7 h2 { background: #ff9966; }   /* Aug */
    .cy-m8 h2 { background: #ffcc99; }   /* Sep */
    .cy-m9 h2 { background: #ff9999; }   /* Oct */
    .cy-m10 h2 { background: #cc99ff; }  /* Nov */
    .cy-m11 h2 { background: #cc99cc; }  /* Dec */

    /* ===== Special days ===== */
    .cy-sunday {
      color: red; /* Sunday text color */
      font-weight: bold; /* bold text */
    }
    .cy-weekend {
      background: #3399ff; /* 2nd/4th Saturday background */
      color: red; /* text color */
      font-weight: bold; /* bold text */
    }
    .cy-holiday {
      background: red !important; /* holiday background color */
      color: white !important; /* holiday text color */
      font-weight: bold; /* bold text */
    }

    /* ===== Holiday list container ===== */
    .cy-holiday-list {
      display: flex; /* flex layout for columns */
      flex-wrap: wrap; /* wrap columns */
      justify-content: center; /* center horizontally */
      gap: 20px; /* gap between columns */
      margin: 20px auto; /* spacing above/below */
      max-width: 1000px; /* max width */
      border: 1px solid #000; /* single border around list */
      padding: 10px; /* inner padding */
      background: #fff; /* list background */
    }

    /* ===== Holiday columns ===== */
    .cy-holiday-column {
      flex: 1 1 200px; /* flexible column width */
      display: flex; /* flex layout */
      flex-direction: column; /* vertical items */
      gap: 5px; /* spacing between items */
    }
    .cy-holiday-item {
      text-align: left; /* align text left */
      font-size: 0.9rem; /* text size */
    }
    .cy-holiday-date {
      display: inline-block; /* inline block for spacing */
      width: 60px; /* fixed width for date */
      font-weight: bold; /* bold text */
    }

    /* ===== Responsive ===== */
    @media (max-width: 768px) {
      .cy-holiday-list {
        flex-direction: column; /* vertical layout */
        align-items: center; /* center columns */
      }
      .cy-holiday-column {
        width: 90%; /* almost full width */
      }
    }
  </style>

  <script src="js/headerfooter.js" defer></script>
</head>
<body>
  <div id="header"></div>

  <h1>Calendar Year (<span id="cy-dynamicYear"></span>)</h1>

  <div class="cy-controls">
    <button onclick="cyPrevYear()">⏮ Prev</button>
    <select id="cy-yearSelect" onchange="cyUpdateCalendar()"></select>
    <button onclick="cyNextYear()">Next ⏭</button>
  </div>

  <div class="cy-calendar" id="cy-calendar"></div>

  <h2>Holidays List (<span id="cy-dynamicYear2"></span>)</h2>
  <div class="cy-holiday-list" id="cy-holidayList"></div>

  <script>
    let cyHolidays = {};
    const cyMonthNames = ["January","February","March","April","May","June","July","August","September","October","November","December"];

    const cyYearSelect = document.getElementById("cy-yearSelect");
    const thisYear = new Date().getFullYear();
    for (let y = thisYear-5; y <= thisYear+5; y++) {
      let opt = document.createElement("option");
      opt.value = y;
      opt.text = y;
      if (y === thisYear) opt.selected = true;
      cyYearSelect.add(opt);
    }

    function cyGenerateYearCalendar(year) {
      document.getElementById("cy-dynamicYear").innerText = year;
      document.getElementById("cy-dynamicYear2").innerText = year;

      const calendar = document.getElementById("cy-calendar");
      calendar.innerHTML = "";
      let holidayDates = {};
      if (cyHolidays[year]) {
        cyHolidays[year].forEach(h => holidayDates[h.date] = h.name);
      }

      for (let m = 0; m < 12; m++) {
        let div = document.createElement("div");
        div.className = "cy-month cy-m"+m;
        let h2 = document.createElement("h2");
        h2.innerText = cyMonthNames[m];
        div.appendChild(h2);

        let table = document.createElement("table");
        let header = "<tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr>";
        table.innerHTML = header;

        const firstDay = new Date(year, m, 1).getDay();
        const daysInMonth = new Date(year, m+1, 0).getDate();

        let row = "<tr>";
        for (let i=0; i<firstDay; i++) row += "<td></td>";

        for (let d=1; d<=daysInMonth; d++) {
          let dateKey = String(m+1).padStart(2,"0")+"-"+String(d).padStart(2,"0");
          let day = new Date(year, m, d).getDay();
          let cls = "";

          if (day === 0) cls = "cy-sunday";
          if (day === 6) {
            let weekNumber = Math.floor((d+firstDay)/7)+1;
            if (weekNumber===2 || weekNumber===4) cls = "cy-weekend";
          }
          if (holidayDates[dateKey]) cls = "cy-holiday";

          row += `<td class="${cls}">${d}</td>`;
          if (day === 6) { row += "</tr><tr>"; }
        }
        row += "</tr>";
        table.innerHTML += row;
        div.appendChild(table);
        calendar.appendChild(div);
      }

      // Holiday list, max 5 per column
      const list = document.getElementById("cy-holidayList");
      list.innerHTML = "";

      if (cyHolidays[year]) {
        const maxPerColumn = 5;
        let holidays = [...cyHolidays[year]];
        let numCols = Math.ceil(holidays.length / maxPerColumn);

        for (let c = 0; c < numCols; c++) {
          let div = document.createElement("div");
          div.className = "cy-holiday-column";

          holidays.slice(c*maxPerColumn, (c+1)*maxPerColumn).forEach(h => {
            let item = document.createElement("div");
            item.className = "cy-holiday-item";
            item.innerHTML = `<span class="cy-holiday-date">${h.date}</span> ${h.name}`;
            div.appendChild(item);
          });
          list.appendChild(div);
        }
      }
    }

    function cyUpdateCalendar(){ cyGenerateYearCalendar(parseInt(cyYearSelect.value)); }
    function cyPrevYear(){ cyYearSelect.value = parseInt(cyYearSelect.value)-1; cyUpdateCalendar(); }
    function cyNextYear(){ cyYearSelect.value = parseInt(cyYearSelect.value)+1; cyUpdateCalendar(); }

    fetch("data/holidays.json")
      .then(r=>r.json())
      .then(data=>{ cyHolidays=data; cyUpdateCalendar(); })
      .catch(()=>cyUpdateCalendar());
  </script>

  <div id="footer"></div>
</body>
</html>
