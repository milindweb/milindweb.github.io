<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Milindweb - Calendar Year</title>

  <!-- Shared Header + Footer CSS -->
  <link rel="stylesheet" href="css/headerfooter.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #fff;
      color: #000;
      text-align: center;
    }
    h1 {
      margin: 10px 0;
      font-size: 1.8rem;
    }

    /* Controls */
    .controls {
      margin: 10px;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
    }
    select, button {
      padding: 6px 12px;
      font-size: 15px;
      border-radius: 4px;
      border: 1px solid #999;
      cursor: pointer;
    }

    /* Calendar Layout */
    .calendar {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      padding: 10px;
    }
    .month {
      flex: 1 1 230px;
      max-width: 250px;
      border: 1px solid #999;
      border-radius: 4px;
      overflow: hidden;
    }
    .month h2 {
      margin: 0;
      padding: 4px;
      font-size: 1rem;
      color: #000;
    }
    .month table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
    }
    th, td {
      border: 1px solid #999;
      padding: 4px;
      text-align: center;
      min-width: 24px;
    }
    th {
      font-weight: bold;
    }

    /* Colors for months */
    .m0 h2 { background: #99ccff; }   /* Jan */
    .m1 h2 { background: #ccffff; }   /* Feb */
    .m2 h2 { background: #99ffcc; }   /* Mar */
    .m3 h2 { background: #ccff99; }   /* Apr */
    .m4 h2 { background: #ccff66; }   /* May */
    .m5 h2 { background: #ffff99; }   /* Jun */
    .m6 h2 { background: #ffcc66; }   /* Jul */
    .m7 h2 { background: #ff9966; }   /* Aug */
    .m8 h2 { background: #ffcc99; }   /* Sep */
    .m9 h2 { background: #ff9999; }   /* Oct */
    .m10 h2 { background: #cc99ff; }  /* Nov */
    .m11 h2 { background: #cc99cc; }  /* Dec */

    /* Sundays */
    .sunday {
      color: red;
      font-weight: bold;
    }
    /* 2nd/4th Saturdays */
    .weekend {
      background: #3399ff;
      color: red;
      font-weight: bold;
    }
    /* Holidays */
    .holiday {
      background: red !important;
      color: white !important;
      font-weight: bold;
    }

    /* Holiday list */
    .holiday-table {
      margin: 20px auto;
      border-collapse: collapse;
      font-size: 0.9rem;
      width: 90%;
      max-width: 800px;
    }
    .holiday-table th, .holiday-table td {
      border: 1px solid #000;
      padding: 6px 10px;
      text-align: left;
    }
    .holiday-table th {
      font-size: 1.2rem;
      text-align: left;
    }
  </style>

  <script src="js/headerfooter.js" defer></script>
</head>
<body>
  <div id="header"></div>

  <h1>Calendar Year <span id="dynamicYear"></span></h1>

  <div class="controls">
    <button onclick="prevYear()">⏮ Prev</button>
    <select id="yearSelect" onchange="updateCalendar()"></select>
    <button onclick="nextYear()">Next ⏭</button>
  </div>

  <div class="calendar" id="calendar"></div>

  <table class="holiday-table">
    <thead>
      <tr><th colspan="3">Holidays List (<span id="dynamicYear2"></span>)</th></tr>
    </thead>
    <tbody id="holidayTableBody"></tbody>
  </table>

  <script>
    let holidays = {};
    const monthNames = ["January","February","March","April","May","June","July","August","September","October","November","December"];

    const yearSelect = document.getElementById("yearSelect");
    const thisYear = new Date().getFullYear();
    for (let y = thisYear-5; y <= thisYear+5; y++) {
      let opt = document.createElement("option");
      opt.value = y;
      opt.text = y;
      if (y === thisYear) opt.selected = true;
      yearSelect.add(opt);
    }

    function generateYearCalendar(year) {
      document.getElementById("dynamicYear").innerText = year;
      document.getElementById("dynamicYear2").innerText = year;

      const calendar = document.getElementById("calendar");
      calendar.innerHTML = "";
      let holidayDates = {};
      if (holidays[year]) {
        holidays[year].forEach(h => holidayDates[h.date] = h.name);
      }

      for (let m = 0; m < 12; m++) {
        let div = document.createElement("div");
        div.className = "month m"+m;
        let h2 = document.createElement("h2");
        h2.innerText = monthNames[m];
        div.appendChild(h2);

        let table = document.createElement("table");
        let header = "<tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr>";
        table.innerHTML = header;

        const firstDay = new Date(year, m, 1).getDay();
        const daysInMonth = new Date(year, m+1, 0).getDate();

        let row = "<tr>";
        for (let i=0; i<firstDay; i++) row += "<td></td>";

        for (let d=1; d<=daysInMonth; d++) {
          let dateKey = String(m+1).padStart(2,"0")+"-"+String(d).padStart(2,"0");
          let day = new Date(year, m, d).getDay();
          let cls = "";

          if (day === 0) cls = "sunday";
          if (day === 6) {
            let weekNumber = Math.floor((d+firstDay)/7)+1;
            if (weekNumber===2 || weekNumber===4) cls = "weekend";
          }
          if (holidayDates[dateKey]) cls = "holiday";

          row += `<td class="${cls}">${d}</td>`;
          if (day === 6) { row += "</tr><tr>"; }
        }
        row += "</tr>";
        table.innerHTML += row;
        div.appendChild(table);
        calendar.appendChild(div);
      }

      // Holiday list
      const tbody = document.getElementById("holidayTableBody");
      tbody.innerHTML = "";
      if (holidays[year]) {
        let chunk = 3; // 3 columns
        for (let i=0; i<holidays[year].length; i+=chunk) {
          let tr = document.createElement("tr");
          for (let j=0; j<chunk; j++) {
            let td = document.createElement("td");
            if (holidays[year][i+j]) {
              td.innerText = holidays[year][i+j].date + "  " + holidays[year][i+j].name;
            }
            tr.appendChild(td);
          }
          tbody.appendChild(tr);
        }
      }
    }

    function updateCalendar(){ generateYearCalendar(parseInt(yearSelect.value)); }
    function prevYear(){ yearSelect.value = parseInt(yearSelect.value)-1; updateCalendar(); }
    function nextYear(){ yearSelect.value = parseInt(yearSelect.value)+1; updateCalendar(); }

    fetch("data/holidays.json")
      .then(r=>r.json())
      .then(data=>{ holidays=data; updateCalendar(); })
      .catch(()=>updateCalendar());
  </script>

  <div id="footer"></div>
</body>
</html>
