<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calendar Year</title>

  <!-- Shared Header + Footer CSS -->
  <link rel="stylesheet" href="css/headerfooter.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f7fa;
      color: #222;
      text-align: center;
    }

    h1 {
      margin: 15px 0;
      font-size: 2rem;
      color: #0f172a;
    }

    /* üîò Controls */
    .controls {
      margin: 15px;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
    }
    select, button {
      padding: 8px 14px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    button:hover, select:hover { background: #e5e7eb; }

    /* üìÖ Calendar Layout */
    .calendar {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      padding: 20px;
    }
    .month {
      flex: 1 1 300px;
      max-width: 340px;
      min-width: 250px;
      border-radius: 12px;
      background: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.08);
      overflow: hidden;
      transition: transform 0.2s ease;
    }
    .month:hover { transform: scale(1.02); }

    .month h2 {
      margin: 0;
      padding: 10px;
      font-size: 1.1rem;
      color: #fff;
      text-align: center;
      background: linear-gradient(90deg, #2563eb, #1d4ed8);
    }
    .month table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }
    th, td {
      border: 1px solid #e2e8f0;
      padding: 6px;
      text-align: center;
      position: relative;
    }
    th { background: #f1f5f9; }

    /* üé® Color Rules */
    .holiday {
      background: #dc2626 !important; /* holiday red */
      color: #fff !important;
      font-weight: bold;
      cursor: pointer;
    }
    .weekend {
      background: #1e40af !important; /* weekend blue */
      color: #dc2626 !important;
      font-weight: bold;
    }

    /* üìù Tooltip */
    .holiday[data-title]:hover::after {
      content: attr(data-title);
      position: absolute;
      bottom: 120%;
      left: 50%;
      transform: translateX(-50%);
      background: #222;
      color: #fff;
      padding: 4px 8px;
      font-size: 0.8rem;
      white-space: nowrap;
      border-radius: 4px;
      pointer-events: none;
      opacity: 0.95;
    }

    /* üìã Holiday List */
    h2 {
      margin-top: 30px;
      font-size: 1.6rem;
      color: #0f172a;
    }
    .holiday-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      padding: 20px;
    }
    .holiday-month {
      flex: 1 1 220px;
      max-width: 280px;
      border-radius: 12px;
      background: #ffffff;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
      overflow: hidden;
      transition: transform 0.2s ease;
    }
    .holiday-month:hover { transform: translateY(-4px); }

    .holiday-month h3 {
      margin: 0;
      padding: 8px;
      font-size: 1.1rem;
      background: linear-gradient(90deg, #0f766e, #115e59);
      color: white;
    }
    .holiday-month ul {
      list-style: none;
      margin: 0;
      padding: 0;
      text-align: left;
    }
    .holiday-month li {
      padding: 8px 12px;
      border-bottom: 1px solid #e2e8f0;
      font-size: 0.9rem;
    }
    .holiday-month li:last-child { border-bottom: none; }

    /* üì± Responsive */
    @media (max-width: 1024px) {
      .holiday-month { flex: 1 1 45%; }
    }
    @media (max-width: 600px) {
      .holiday-month { flex: 1 1 100%; }
    }
  </style>

  <!-- JS Loader -->
  <script src="js/headerfooter.js" defer></script>
</head>
<body>

  <!-- Header -->
  <div id="header"></div>

  <h1>Calendar Year (<span id="dynamicYear"></span>)</h1>

  <div class="controls">
    <button onclick="prevYear()">‚èÆ Prev</button>
    <select id="yearSelect" onchange="updateCalendar()"></select>
    <button onclick="nextYear()">Next ‚è≠</button>
  </div>

  <div class="calendar" id="calendar"></div>

  <h2>List of Holidays (<span id="dynamicYear2"></span>)</h2>
  <div class="holiday-list" id="holidayList"></div>

  <!-- Calendar Script -->
  <script>
    let holidays = {};
    const monthNames = [
      "January","February","March","April","May","June",
      "July","August","September","October","November","December"
    ];

    const yearSelect = document.getElementById("yearSelect");
    const thisYear = new Date().getFullYear();
    for (let y = thisYear - 5; y <= thisYear + 5; y++) {
      let opt = document.createElement("option");
      opt.value = y;
      opt.text = y;
      if (y === thisYear) opt.selected = true;
      yearSelect.add(opt);
    }

    function generateYearCalendar(year) {
      document.getElementById("dynamicYear").innerText = year;
      document.getElementById("dynamicYear2").innerText = year;

      const calendar = document.getElementById("calendar");
      calendar.innerHTML = "";
      let holidayDates = {};
      if (holidays[year]) {
        holidays[year].forEach(h => holidayDates[h.date] = h.name);
      }

      for (let month = 0; month < 12; month++) {
        let div = document.createElement("div");
        div.className = "month";

        let h2 = document.createElement("h2");
        h2.innerText = monthNames[month] + " " + year;
        div.appendChild(h2);

        let table = document.createElement("table");
        let header = "<tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr>";
        table.innerHTML = header;

        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        let row = "<tr>";
        for (let i = 0; i < firstDay; i++) row += "<td></td>";

        for (let date = 1; date <= daysInMonth; date++) {
          let current = new Date(year, month, date);
          let day = current.getDay();
          let classes = "";
          let tooltip = "";

          const key = String(month+1).padStart(2,"0")+"-"+String(date).padStart(2,"0");
          if (holidayDates[key]) {
            classes = "holiday";
            tooltip = ` data-title="${holidayDates[key]}"`;
          }
          if (day === 0) classes = "weekend"; // Sunday
          if (day === 6) {
            let weekNumber = Math.floor((date + firstDay) / 7) + 1;
            if (weekNumber === 2 || weekNumber === 4) classes = "weekend";
          }

          row += `<td class="${classes}"${tooltip}>${date}</td>`;
          if (day === 6) { row += "</tr><tr>"; }
        }

        row += "</tr>";
        table.innerHTML += row;
        div.appendChild(table);
        calendar.appendChild(div);
      }

      // ‚úÖ Holiday list
      const listDiv = document.getElementById("holidayList");
      listDiv.innerHTML = "";
      if (holidays[year]) {
        let grouped = {};
        holidays[year].forEach(h => {
          let m = parseInt(h.date.split("-")[0],10)-1;
          if (!grouped[m]) grouped[m] = [];
          grouped[m].push(h);
        });

        Object.keys(grouped).sort((a,b)=>a-b).forEach(m=>{
          let box = document.createElement("div");
          box.className = "holiday-month";
          box.innerHTML = `<h3>${monthNames[m]}</h3>`;
          let ul = document.createElement("ul");
          grouped[m].forEach(h=>{
            let li = document.createElement("li");
            li.innerText = `${h.date} ‚Äì ${h.name}`;
            ul.appendChild(li);
          });
          box.appendChild(ul);
          listDiv.appendChild(box);
        });
      }
    }

    function updateCalendar() {
      generateYearCalendar(parseInt(yearSelect.value));
    }
    function prevYear() {
      yearSelect.value = parseInt(yearSelect.value) - 1;
      updateCalendar();
    }
    function nextYear() {
      yearSelect.value = parseInt(yearSelect.value) + 1;
      updateCalendar();
    }

    fetch("data/holidays.json")
      .then(res => res.json())
      .then(data => {
        holidays = data;
        updateCalendar();
      })
      .catch(err => {
        console.error("Error loading holidays.json", err);
        updateCalendar();
      });
  </script>

  <!-- Footer -->
  <div id="footer"></div>

</body>
</html>
